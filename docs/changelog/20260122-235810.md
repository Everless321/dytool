# 任务: 用户列表显示已下载作品数量

## 日期
2026-01-22 23:58:10

## 任务描述
在用户列表中显示每个用户已下载的视频数量。

## 待办事项
- [x] 添加 DatabaseService 统计方法
- [x] 更新 UserRowView 显示下载数量
- [x] 添加下载数量缓存和刷新逻辑

## 实施细节

### 1. DatabaseService 新增方法
- `getDownloadedCount(for user:)` - 统计单个用户已下载视频数量
- `getAllDownloadedCounts()` - 批量获取所有用户的下载数量
- `countVideos(in folder:)` - 私有方法，统计文件夹中的 .mp4 文件数量

### 2. UserRowView 更新
- 新增 `downloadedCount` 参数
- 显示绿色的 "X 已下载" 标签（仅当数量 > 0 时显示）

### 3. UserListView 更新
- 新增 `downloadCounts: [String: Int]` 状态缓存
- `onAppear` 时刷新下载数量
- `onChange(of: users)` 时自动刷新

## 目录结构
视频存储路径: `{downloadPath}/douyin/{mode}/{用户昵称}/`

## 执行结果
- 用户列表现在显示每个用户的已下载视频数量
- 数量在视图加载和用户列表变化时自动刷新
