# 应用内视频播放 + 并发下载功能

## 任务描述
1. 用户希望在视频浏览界面点击视频后能够在应用内直接播放，而不是打开系统默认播放器
2. 实现并发下载功能，使用设置中的 parallel 和 maxWorkers 参数

## 待办事项
- [x] 添加 AVPlayer 状态变量
- [x] 修改 LocalVideoGridItem 组件，使用 onPlay 回调替代 NSWorkspace.open
- [x] 修改 LocalVideoListItem 组件，使用 onPlay 回调替代 NSWorkspace.open
- [x] 创建 VideoPlayerOverlay 覆盖层组件
- [x] 实现 playVideo 和 stopVideo 方法
- [x] 实现并发下载逻辑 (DispatchGroup + DispatchSemaphore)
- [x] 更新 DownloadState 传入并发参数
- [x] 编译验证

## 修改文件
- `dyTool/Views/VideoGalleryView.swift` - 应用内视频播放
- `dyTool/Services/F2Service.swift` - 并发下载逻辑
- `dyTool/Services/DownloadState.swift` - 传入并发参数

## 实现详情

### 应用内视频播放
1. 添加 `@State private var player: AVPlayer?` 状态
2. 创建 `VideoPlayerOverlay` 组件，包含深色背景、标题、关闭按钮、AVKit VideoPlayer
3. 单击触发应用内播放而非系统播放器

### 并发下载
1. 新增 `downloadUsersParallel` 方法，使用 DispatchGroup + DispatchSemaphore 控制并发
2. 根据 `settings.parallel` 决定使用串行或并发模式
3. 根据 `settings.maxWorkers` 限制最大并发数
4. 使用 NSLock 保护计数器和进程列表
5. 停止下载时终止所有活动进程

## 执行结果
功能实现完成，编译通过。
