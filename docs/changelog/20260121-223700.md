# 视频内容分析功能

## 任务描述
将 Python 版本的 video_content_analyzer.py 功能移植到 macOS 应用中，实现使用 Gemini/Grok API 分析视频内容并生成标签。

## 待办事项
- [x] 创建 VideoAnalysis 数据模型
- [x] 扩展 DatabaseService 添加分析表和方法
- [x] 创建 AnalysisService 视频分析服务
- [x] 创建 AnalysisView 分析页面 UI
- [x] 在主窗口添加分析页面入口
- [x] 编译验证

## 新增文件
- `dyTool/Models/VideoAnalysis.swift` - 视频分析数据模型
- `dyTool/Services/AnalysisService.swift` - 视频分析服务
- `dyTool/Views/AnalysisView.swift` - 分析页面 UI

## 修改文件
- `dyTool/Services/DatabaseService.swift` - 添加分析表和相关方法
- `dyTool/Views/MainView.swift` - 添加"内容分析"导航项

## 功能说明

### 1. 数据模型 (VideoAnalysis.swift)
- `VideoAnalysis` 结构体：存储分析结果（标签、分类、摘要、擦边等级等）
- `AnalysisConfig` 配置：API 提供商、API Key、抽帧数量等
- `TagSystem` 标签体系定义

### 2. 分析服务 (AnalysisService.swift)
- 使用 ffmpeg 抽取视频关键帧
- 支持 Gemini 和 Grok 两种 API
- 批量分析功能，支持进度跟踪
- 自动保存分析结果到数据库

### 3. 分析页面 (AnalysisView.swift)
- 左侧配置面板：API 配置、分析选项、待分析视频列表
- 右侧内容区：分析日志和分析结果两个标签页
- 流式布局显示标签
- 擦边等级颜色指示

### 4. 数据库扩展
- `video_analysis` 表存储分析结果
- API Key 加密存储在 settings 表

## 使用方法
1. 在侧边栏点击"内容分析"
2. 选择 API 提供商（Gemini 或 Grok）
3. 输入对应的 API Key
4. 点击"开始分析"

## 执行结果
功能实现完成，编译通过。
